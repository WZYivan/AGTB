#ifndef __AGTB_GEODESY_EXMATH_PRE_CORRECTION_HPP__
#define __AGTB_GEODESY_EXMATH_PRE_CORRECTION_HPP__

#include "../Base/GeoLatLon.hpp"
#include "../../Utils/Angles.hpp"
#include "../Ellipsoid/Base.hpp"
#include "../../Utils/Math.hpp"
#include <numbers>

AGTB_GEODESY_BEGIN

namespace PreCorrection
{
    namespace MeridianArcBottomImpl
    {
        template <EllipsoidType __ellipsoid_type>
        struct SinCoeff
        {
            AGTB_TEMPLATE_NOT_SPECIFIED();
        };

        template <>
        struct SinCoeff<EllipsoidType::CGCS2000>
        {
            constexpr static double a = 1.3086454276230437, b = 1.0001974166282752, c = 0.0005855305637564773;
        };

        template <>
        struct SinCoeff<EllipsoidType::IE1975>
        {
            constexpr static double a = 1.3086473387873636, b = 1.0001978904051434, c = 0.0005854724070249471;
        };

        template <>
        struct SinCoeff<EllipsoidType::WGS84>
        {
            constexpr static double a = 1.308645412315567, b = 1.0001974204047577, c = 0.0005855463063938729;
        };

        template <>
        struct SinCoeff<EllipsoidType::Krasovski>
        {
            constexpr static double a = 1.3082694492087268, b = 1.0002145971858798, c = 0.0005854719425683429;
        };

        template <typename T>
        concept SinCoeffConcept = requires {
            { T::a } -> std::convertible_to<double>;
            { T::b } -> std::convertible_to<double>;
            { T::c } -> std::convertible_to<double>;
        };

        template <SinCoeffConcept coeff>
        constexpr double SinFit(double len)
        {
            return coeff::a * gcem::sin(2 * std::numbers::pi / coeff::b * len / 1e7 + coeff::c);
        }

        template <EllipsoidType __ellipsoid_type>
        struct DoubleGaussianCoeff
        {
            AGTB_TEMPLATE_NOT_SPECIFIED();
        };

        template <>
        struct DoubleGaussianCoeff<EllipsoidType::CGCS2000>
        {
            constexpr static double
                offset = -0.002304851335706558,
                amp1 = 0.0026509163109794173,
                center1 = 0.21313102107150536,
                sigma1 = 0.2016711030899239,
                amp2 = 0.00265411907874458,
                center2 = 0.7849789498882686,
                sigma2 = 0.20410811343744764;
        };
        template <>
        struct DoubleGaussianCoeff<EllipsoidType::IE1975>
        {
            constexpr static double
                offset = -0.002304604685817817,
                amp1 = 0.0026506312176421552,
                center1 = 0.2131298357210478,
                sigma1 = 0.20166936609659156,
                amp2 = 0.002653836323793295,
                center2 = 0.7849780926138245,
                sigma2 = 0.20411007651540564;
        };
        template <>
        struct DoubleGaussianCoeff<EllipsoidType::WGS84>
        {
            constexpr static double
                offset = -0.0023048576875828097,
                amp1 = 0.002650920166500137,
                center1 = 0.2131322886065555,
                sigma1 = 0.2016704151835333,
                amp2 = 0.002654124014687272,
                center2 = 0.784979490418362,
                sigma2 = 0.2041091519216842;
        };
        template <>
        struct DoubleGaussianCoeff<EllipsoidType::Krasovski>
        {
            constexpr static double
                offset = -0.0023038979866213008,
                amp1 = 0.0026498159983222892,
                center1 = 0.2131336406624428,
                sigma1 = 0.20167166145188709,
                amp2 = 0.0026530214747364747,
                center2 = 0.7849910396116169,
                sigma2 = 0.20411477558695162;
        };

        template <typename T>
        concept DoubleGaussianCoeffConcept = requires {
            { T::offset } -> std::convertible_to<double>;
            { T::amp1 } -> std::convertible_to<double>;
            { T::center1 } -> std::convertible_to<double>;
            { T::sigma1 } -> std::convertible_to<double>;
            { T::amp2 } -> std::convertible_to<double>;
            { T::center2 } -> std::convertible_to<double>;
            { T::sigma2 } -> std::convertible_to<double>;
        };

        template <DoubleGaussianCoeffConcept coeff>
        constexpr double DoubleGaussianFit(double len)
        {
            double &&x{len / 1e7};
            return (coeff::offset +
                    coeff::amp1 * gcem::exp(-0.5 * gcem::pow((x - coeff::center1) / coeff::sigma1, 2)) +
                    coeff::amp2 * gcem::exp(-0.5 * gcem::pow((x - coeff::center2) / coeff::sigma2, 2)));
        }

        template <EllipsoidType __ellipsoid_type>
        consteval CubicSpline<double, 88> PreDefinedCubicSpline()
        {
            AGTB_TEMPLATE_NOT_SPECIFIED();
            return {};
        }

        template <>
        consteval CubicSpline<double, 88> PreDefinedCubicSpline<EllipsoidType::CGCS2000>()
        {
            return {
                .x_knots{0.0110574388549896, 0.0221149453356417, 0.0331725869872925, 0.0442304311947144, 0.0552885451020539, 0.0663469955330326, 0.0774058489115002, 0.0884651711824254, 0.0995250277334133, 0.1105854833168336, 0.1216466019726486, 0.132708446952025, 0.1437710806418147, 0.1548345644899905, 0.1658989589321189, 0.1769643233189536, 0.1880307158452333, 0.1990981934797632, 0.2101668118968621, 0.2212366254092524, 0.2323076869024751, 0.2433800477709015, 0.2544537578554224, 0.2655288653828859, 0.276605416907357, 0.2876834572532729, 0.29876302946056, 0.3098441747317843, 0.3209269323813978, 0.3320113397871493, 0.3430974323437188, 0.3541852434186368, 0.3652748043105478, 0.3763661442098727, 0.3874592901619242, 0.3985542670325264, 0.4096510974761874, 0.4207498019068706, 0.4318503984714098, 0.4429529030256046, 0.4540573291130398, 0.4651636879466584, 0.476271988393123, 0.487382236959992, 0.4984944377857385, 0.5096085926326323, 0.5207247008825037, 0.5318427595354058, 0.5429627632111854, 0.5540847041539723, 0.565208572239591, 0.5763343549858939, 0.5874620375660186, 0.5985916028245553, 0.6097230312966205, 0.6208563012298189, 0.631991388609077, 0.6431282671843249, 0.6542669085010037, 0.6654072819333634, 0.6765493547205244, 0.6876930920052561, 0.6988384568754413, 0.7099854104081712, 0.7211339117164293, 0.7322839179983056, 0.7434353845886882, 0.754588265013369, 0.7657425110454996, 0.7768980727643331, 0.7880548986161718, 0.7992129354774592, 0.810372128719923, 0.8215324222777013, 0.8326937587163575, 0.8438560793037029, 0.8550193240823338, 0.8661834319437882, 0.8773483407042324, 0.8885139871815707, 0.8996803072738866, 0.910847236039104, 0.922014707775774, 0.9331826561048676, 0.944351014052479, 0.9555197141333206, 0.9666886884349036, 0.9778578687022892, 0.9890271864233002},

                .y_knots{1.065105198290331e-05, 3.5845362148063335e-06, -1.2424809764587878e-06, -4.2257245972762854e-06, -5.732288648950816e-06, -6.097378024773478e-06, -5.621870939556673e-06, -4.570751190546756e-06, -3.1723977730239877e-06, -1.6186313377433389e-06, -6.554204153735345e-08, 1.3650031186464523e-06, 2.5832849001201095e-06, 3.5291651014169667e-06, 4.169022198540037e-06, 4.492516669453461e-06, 4.509063496951004e-06, 4.244186604630547e-06, 3.735957520074667e-06, 3.0314465871255887e-06, 2.1833551233308096e-06, 1.2470096767118076e-06, 2.773958927695464e-07, -6.732696145618218e-07, -1.5574159982754444e-06, -2.334038331049484e-06, -2.9698315231227283e-06, -3.4399423543858684e-06, -3.728568393702292e-06, -3.828822652883062e-06, -3.7426863491468883e-06, -3.4800929652921897e-06, -3.0582977523438957e-06, -2.500818778178402e-06, -1.836106632000119e-06, -1.096088892880813e-06, -3.150761857574364e-07, 4.7188895805532274e-07, 1.2302758174734208e-06, 1.9276600818085316e-06, 2.534523056831571e-06, 3.0256170396699344e-06, 3.3806547461976734e-06, 3.5851226043948038e-06, 3.6308756072691087e-06, 3.516106090027454e-06, 3.245543948932582e-06, 2.830449566958203e-06, 2.287951564500278e-06, 1.640606001550391e-06, 9.153844942107626e-07, 1.4320846088719877e-07, -6.428144304867264e-07, -1.4080826413796852e-06, -2.11812133290158e-06, -2.7399595661930804e-06, -3.243314139789698e-06, -3.601909892899085e-06, -3.7951326733597253e-06, -3.8085211400704436e-06, -3.6353894582604428e-06, -3.2770311289911924e-06, -2.7435550666379815e-06, -2.0536358008760476e-06, -1.2348949840128125e-06, -3.229165889207311e-07, 6.396968252196829e-07, 1.6041073148337706e-06, 2.517737390295583e-06, 3.3258088055414074e-06, 3.974202518550879e-06, 4.411849539071207e-06, 4.594261689818378e-06, 4.4865679636445915e-06, 4.0670815428735414e-06, 3.3310420302448164e-06, 2.293653737219306e-06, 9.941600965976925e-07, -5.017151761357343e-07, -2.0979878567980483e-06, -3.6668000458809323e-06, -5.045617320377071e-06, -6.0367928155693334e-06, -6.405855305036557e-06, -5.882286295744513e-06, -4.160173283344285e-06, -8.994613611100748e-07, 4.271019138663229e-06, 1.1750038532456998e-05},

                .a{1.038605396842306e-05, 3.0862783501076024e-06, -1.1316668136375322e-06, -3.961059516429101e-06, -5.701177596913286e-06, -5.752768979785241e-06, -5.4047676801884275e-06, -4.609981220107576e-06, -3.3003490057474526e-06, -1.7762338381658401e-06, -1.788163224716047e-07, 1.3273426810526932e-06, 2.5524942545057907e-06, 3.3298016571928637e-06, 4.083618090443442e-06, 4.7016313032502565e-06, 4.740264898795838e-06, 4.201261995967344e-06, 3.700099024928939e-06, 3.1714280574703628e-06, 2.2462959083332464e-06, 1.0223218302855354e-06, 1.0126054292796637e-08, -7.886412878534477e-07, -1.5653583450438478e-06, -2.190943139078786e-06, -2.7796779072872105e-06, -3.323356904192184e-06, -3.647954793581261e-06, -3.7570241725528396e-06, -3.744607652147152e-06, -3.5731787967254046e-06, -3.176865501597422e-06, -2.554049403132278e-06, -1.8873914536800647e-06, -1.1745513562781496e-06, -3.120471133830203e-07, 6.609026211684432e-07, 1.4580325028066094e-06, 2.05666784082084e-06, 2.560861239220733e-06, 2.886221973664328e-06, 3.1865661624537996e-06, 3.457763729929373e-06, 3.5420759437229973e-06, 3.460210657690154e-06, 3.2588791748227463e-06, 2.9102270943795617e-06, 2.393112654103166e-06, 1.7035394992558354e-06, 9.766069538009717e-07, 2.1672519190739795e-07, -6.519810715620554e-07, -1.5970631890965765e-06, -2.344146264251342e-06, -2.8675799607537615e-06, -3.268440560353525e-06, -3.4639833637939796e-06, -3.6035581601403313e-06, -3.6825414910866597e-06, -3.5461849727240316e-06, -3.214044727930743e-06, -2.754707530966975e-06, -2.142730586840452e-06, -1.345762031131074e-06, -3.6611529525037614e-07, 5.940142899250882e-07, 1.5227477183049724e-06, 2.5212503114826806e-06, 3.5362903639717393e-06, 4.223706347489581e-06, 4.545567663295633e-06, 4.614028562945259e-06, 4.319933176882155e-06, 3.855139415074198e-06, 3.2068811673753954e-06, 2.1696899836848125e-06, 7.63975891919636e-07, -6.145144023601156e-07, -1.9716751090385365e-06, -3.5004423249308166e-06, -5.111997922230352e-06, -6.018912713344661e-06, -6.143914669307926e-06, -5.561149233334107e-06, -4.009032597056084e-06, -7.604941157000828e-07, 4.391233811546885e-06},

                .b{-0.0008585844545633476, -0.0004912765876398977, -0.0003011571486525086, -0.0002160638489929557, -7.428789163487478e-05, 2.713253715396033e-05, 4.6166308777463896e-05, 9.820276024767493e-05, 0.00013185797443742594, 0.00014300013107349278, 0.00014278906861078233, 0.00012757005612840913, 8.764602349397384e-05, 6.486506934646603e-05, 6.805943218456623e-05, 3.4840713658381e-05, -2.939287542908036e-05, -5.289715316207346e-05, -4.0957651310055626e-05, -6.237950626194538e-05, -0.00010348475315369074, -0.00010599813867896376, -7.837012188818951e-05, -7.110700313625407e-05, -6.393752731728293e-05, -5.2924471375352105e-05, -5.318753818904228e-05, -4.0926557500174464e-05, -1.8163936792136765e-05, -3.8045995532207795e-06, 7.222113648803375e-06, 2.465809906908062e-05, 4.773947431540862e-05, 6.0054566822042446e-05, 6.079161343830702e-05, 6.981461653468015e-05, 8.587118578318549e-05, 8.286514551465603e-05, 6.108918751624541e-05, 4.996565641341337e-05, 3.701932189523007e-05, 2.60583394168068e-05, 2.7745538297954584e-05, 1.7301908263499593e-05, -9.60166345551974e-07, -1.2795453614325354e-05, -2.4289873948895624e-05, -3.845611615486967e-05, -5.547089753521385e-05, -6.517127333716868e-05, -6.589419972159625e-05, -7.219599062045758e-05, -8.441983262470193e-05, -7.907398405313784e-05, -5.537959599504214e-05, -4.1799607207786816e-05, -2.6467437888533348e-05, -1.3006490283446643e-05, -1.1773085382722503e-05, 1.237133840814036e-06, 2.226719481493278e-05, 3.58219994022317e-05, 4.7499343294460974e-05, 6.252195999844248e-05, 8.157403018990772e-05, 8.922216631286584e-05, 8.341655976974057e-05, 8.522763131281438e-05, 9.404445413825909e-05, 8.011591637994851e-05, 4.330460209537625e-05, 1.8046539334257132e-05, -1.054813970183445e-05, -3.650288689935384e-05, -4.742531131764753e-05, -7.295164185131739e-05, -0.00011372707344978673, -0.00012861327129926254, -0.00011996040445896274, -0.00012658787305377267, -0.00014905757191906353, -0.00012085247852493666, -4.411082331128594e-05, 2.008435091488096e-05, 8.673371084492147e-05, 0.00020643045201009045, 0.00037701445529027955, 0.0005418063013628196},

                .c{0.020615077287628972, 0.012602888043537458, 0.0045906008555177905, 0.0031046874903280577, 0.009716301563147078, -0.0005449959248164084, 0.0022661302026759627, 0.0024390814003002973, 0.0006039249926483331, 0.00040346177836037125, -0.00042254325368651174, -0.0009532681512597191, -0.002655640337799561, 0.00059652817565146, -0.0003078216535902608, -0.002694223047776109, -0.003110160714585828, 0.0009864358235897887, 9.224458638564144e-05, -0.002027404101757111, -0.001685450976945913, 0.0014584546249357408, 0.0010364650162596096, -0.00038065930657013624, 0.0010279253625381708, -3.379141844299333e-05, 1.0048009512715454e-05, 0.00109642432604156, 0.0009574526446266189, 0.0003380011142694298, 0.0006566426834219248, 0.0009158936181497765, 0.0011654669939880837, -5.513292989691443e-05, 0.00012157455244929144, 0.0006916766333446098, 0.0007552743072888495, -0.0010261203584927229, -0.0009355722290907044, -6.632162724906144e-05, -0.001099549928493225, 0.00011263939889240442, 3.924692154690199e-05, -0.0009792465958654531, -0.0006641789411118064, -0.0004007052027402274, -0.0006333275788947678, -0.0006408375112737606, -0.0008892682221806293, 1.708450426167912e-05, -8.207326346515963e-05, -0.0004843399986449042, -0.0006141674323702036, 0.0010944960388684299, 0.0010341066034211587, 0.0001856598145977758, 0.0011912642091699713, 1.7418054368762833e-05, 9.331402377772295e-05, 0.0010745300617486572, 0.0008129159616117164, 0.0004034447835281281, 0.0006442861816076192, 0.0007034019252703649, 0.0010055336226272465, -0.000319602518230495, -0.0002010112051816578, 0.0003633971964333957, 0.0004270482357407883, -0.0016756216477632094, -0.0016238216503057905, -0.0006398438201634454, -0.0019225886437964817, -0.00040304437500794454, -0.0005755503012052779, -0.001711279783446559, -0.0019413707144196968, 0.000607972825917348, 0.00016703277654273746, -0.0007605916545047986, -0.0012516826381472187, 0.0037774526136824505, 0.0030944389857078193, 0.002653722837259435, 0.0033139727042588163, 0.00740318688448265, 0.00786983628435133, 0.006884321328606023},

                .d{-0.2415309231519428, -0.24153092315193947, -0.044792135408346374, 0.19929902839430721, -0.30930486303993976, 0.08473229641709042, 0.005212832920121451, -0.05530983152724644, -0.006041439335418571, -0.02489214872833372, -0.015992657601050526, -0.051294963877997445, 0.09798506383946012, -0.027245046681703772, -0.07188801955240716, -0.012528553330032931, 0.12338242050126115, -0.026928721770213368, -0.06382669065955063, 0.01029570425625807, 0.09464725241650182, -0.012702445866689728, -0.04265193571305832, 0.042389386443857174, -0.03194658826015765, 0.0013189266136368614, 0.03267942346927991, -0.004179816546524971, -0.018628315966197306, 0.009580819918486421, 0.007793871816422217, 0.007501751069342684, -0.03668327226359447, 0.00530980971223109, 0.017127933584848657, 0.0019103855606076683, -0.053501579903829935, 0.002719016912756836, 0.026097733101528534, -0.031015509584755248, 0.036381240258999865, -0.0022023314217211776, -0.030557177644957644, 0.009451102732162308, 0.007902047494123151, -0.0069755340905762325, -0.00022515718536376194, -0.007446961294565277, 0.02716410535129736, -0.0029713215751822272, -0.012052087910051936, -0.003889022797888236, 0.051174909098629484, -0.0018083763342929373, -0.02540274312680863, 0.03010317327925031, -0.0351339065930053, 0.0022712515602573103, 0.029359160592132682, -0.007826613746962223, -0.012248170358568906, 0.007203036146555834, 0.001767769806317107, 0.009033551954739262, -0.03961540790076126, 0.0035448644680547187, 0.01686883806763915, 0.0019021467736454404, -0.06282874666765673, 0.001547632458231453, 0.029395189684792482, -0.03831653405289296, 0.045385433065945446, -0.005151889804159962, -0.033915572583501696, -0.006870491377011184, 0.07611724919340246, -0.013164461941591392, -0.027692811545670666, -0.014659887339260332, 0.15011991681169454, -0.02038699668943746, -0.013154196141239778, 0.019705966627517117, 0.12204387113466414, 0.013926954772756933, -0.02941173634807118, -0.029411736348074716},
                .threshold{1.1260702102689778e-05}};
        }

        template <>
        consteval CubicSpline<double, 88> PreDefinedCubicSpline<EllipsoidType::IE1975>()
        {
            return {
                .x_knots{0.0110574440356047, 0.0221149556969424, 0.0331726025294202, 0.0442304519178809, 0.0552885710065412, 0.0663470266191929, 0.0774058851797554, 0.0884652126332671, 0.0995250743674019, 0.1105855351345982, 0.1216466589748864, 0.1327085091395007, 0.1437711480153599, 0.1548346370505031, 0.1658990366805622, 0.1769644062563556, 0.1880308039726859, 0.1990982867984215, 0.2101669104079428, 0.2212367291140337, 0.2323077958022947, 0.2433801618671564, 0.2544538771495672, 0.2655289898764315, 0.2766055466018698, 0.2876835921503732, 0.2987631695619206, 0.3098443200391291, 0.3209270828965004, 0.3320114955118314, 0.3430975932798485, 0.354185409568127, 0.3652749756753548, 0.3763663207919938, 0.3874594719633966, 0.3985544540554245, 0.4096512897226214, 0.4207499993789845, 0.4318506011713784, 0.4429531109556328, 0.4540575422753592, 0.4651639063435257, 0.4762722120268169, 0.4873824658328116, 0.4984946719000001, 0.5096088319906671, 0.5207249454866554, 0.5318430093880276, 0.5429630183146371, 0.5540849645106183, 0.5652088378517959, 0.5763346258560212, 0.5874623136964264, 0.5985918842175942, 0.6097233179546299, 0.620856593155124, 0.6319916858039855, 0.6431285696511241, 0.6542672162419568, 0.665407594950707, 0.6765496730164642, 0.6876934155819643, 0.6988387857350529, 0.7099857445527812, 0.7211342511480886, 0.7322842627190186, 0.7434357346004089, 0.7545886203179981, 0.765742871644882, 0.7768984386602524, 0.7880552698103508, 0.7992133119715539, 0.8103725105155212, 0.8215328093763193, 0.8326941511194378, 0.8438564770126116, 0.8550197270983567, 0.8661838402681311, 0.8773487543380164, 0.8885144061258314, 0.8996807315295718, 0.9108476656070722, 0.9220151426567922, 0.9331830962996104, 0.944351459561527, 0.9555201649571586, 0.966689144573922, 0.9778583301567808, 0.9890276531934604},

                .y_knots{1.0648948568375578e-05, 3.5835021278472594e-06, -1.2427184401242724e-06, -4.225386935610351e-06, -5.731582208919506e-06, -6.0964688568597805e-06, -5.620882098410934e-06, -4.569798152309669e-06, -3.1715487978006748e-06, -1.6179501323086677e-06, -6.505802790522826e-08, 1.365276804146903e-06, 2.583371671651503e-06, 3.5290347205539597e-06, 4.168716552956813e-06, 4.492068003101939e-06, 4.508502926717814e-06, 4.2435571705805265e-06, 3.7352918296507673e-06, 3.030777874194965e-06, 2.18275041218534e-06, 1.2464305149494223e-06, 2.7691349367930896e-07, -6.736260561184307e-07, -1.5576395371886815e-06, -2.3341475830987316e-06, -2.9697709832442794e-06, -3.439791806750177e-06, -3.728305597566718e-06, -3.828475033745593e-06, -3.742264741785127e-06, -3.4795477295291297e-06, -3.057760509833597e-06, -2.5002250963196285e-06, -1.8355048360450908e-06, -1.0955585949420053e-06, -3.1459989489153115e-07, 4.7223486582606555e-07, 1.2305894936783315e-06, 1.9278200233553006e-06, 2.534597057816815e-06, 3.0255630479319876e-06, 3.3804816536911995e-06, 3.584824150298189e-06, 3.63048102081597e-06, 3.515595758565252e-06, 3.2450424513961584e-06, 2.8298718460289477e-06, 2.287384775864071e-06, 1.6399845149505776e-06, 9.149008492941122e-07, 1.4276586161876548e-07, -6.431615218759935e-07, -1.4083255640072283e-06, -2.118284590900063e-06, -2.7399700205097462e-06, -3.2431871084459205e-06, -3.6017025477385126e-06, -3.794756372505533e-06, -3.8080997407635014e-06, -3.634881332989417e-06, -3.2765118907714975e-06, -2.7429474936469314e-06, -2.0530779558177066e-06, -1.2343727783426135e-06, -3.2239766134273956e-07, 6.400855997951496e-07, 1.6044537531397646e-06, 2.5178491950723914e-06, 3.325819047496261e-06, 3.9740307929149975e-06, 4.411533592612975e-06, 4.593876685199914e-06, 4.486007763071596e-06, 4.0665259888285e-06, 3.330369410575653e-06, 2.293088052163217e-06, 9.935879176593485e-07, -5.021479604137673e-07, -2.0982439767618273e-06, -3.666909728772174e-06, -5.045594789469376e-06, -6.036510621285768e-06, -6.405472077235502e-06, -5.881854061621887e-06, -4.1594778516173235e-06, -8.989660777304447e-07, 4.27119489030737e-06, 1.1749762638943017e-05},

                .a{1.0383955050591078e-05, 3.0852929341553936e-06, -1.1319295610791854e-06, -3.9607315598919476e-06, -5.700473239406302e-06, -5.7518772924568076e-06, -5.403794880239921e-06, -4.609021813235413e-06, -3.2994941205850797e-06, -1.7755431555757261e-06, -1.7832362720325074e-07, 1.32762569226761e-06, 2.5525659583520513e-06, 3.3296827813091266e-06, 4.083316840964848e-06, 4.701171188957006e-06, 4.739695952247863e-06, 4.2006432203759655e-06, 3.6994412127010855e-06, 3.1707503049496907e-06, 2.2456566569176232e-06, 1.0217751853960698e-06, 9.670851745382717e-09, -7.890029466429886e-07, -1.5655963933525324e-06, -2.191038484786036e-06, -2.7796431722900524e-06, -3.323206232865494e-06, -3.647695483070908e-06, -3.7566730916100563e-06, -3.744171479825225e-06, -3.5726667700133154e-06, -3.1763018562384363e-06, -2.5534589572742306e-06, -1.8868034630925007e-06, -1.1740001940133308e-06, -3.115683262030214e-07, 6.612691745464163e-07, 1.4582957717561504e-06, 2.0568387744572027e-06, 2.560921936447701e-06, 2.886166208119706e-06, 3.1863966679709034e-06, 3.4574828138250263e-06, 3.5416913591483494e-06, 3.459733527571089e-06, 3.258335415678336e-06, 2.9096475765679596e-06, 2.3925258603507836e-06, 1.7029807999602613e-06, 9.760912436504556e-07, 2.1626874384523386e-07, -6.523439708692022e-07, -1.5973010441621764e-06, -2.3442662705576556e-06, -2.8675897677135856e-06, -3.268330128781836e-06, -3.4637520830043966e-06, -3.6032213034355553e-06, -3.682116399180219e-06, -3.5456899132185916e-06, -3.2135041358581457e-06, -2.75413860098703e-06, -2.1421536411506853e-06, -1.345208324265301e-06, -3.6561724183522807e-07, 5.944303026431959e-07, 1.5230520488863486e-06, 2.5214070592740342e-06, 3.536262766810749e-06, 4.223524155074697e-06, 4.545265073266652e-06, 4.6136062160689255e-06, 4.319409429281101e-06, 3.854551397160456e-06, 3.2062688296803263e-06, 2.169100819240942e-06, 7.634658640438993e-07, -6.14930635739801e-07, -1.9719800635636476e-06, -3.5005879667951693e-06, -5.11194266737384e-06, -6.018682813929586e-06, -6.143538332153888e-06, -5.5606380075098165e-06, -4.0084167725494685e-06, -7.599876020811767e-07, 4.391392102414017e-06},

                .b{-0.0008584549296134821, -0.0004911987039450024, -0.00030109857734740136, -0.0002160187998631399, -7.42637047538966e-05, 2.7143903689558014e-05, 4.6169441990265505e-05, 9.819708659721079e-05, 0.0001318452838340078, 0.00014298331769186843, 0.00014277038013853826, 0.00012755066390632383, 8.762776387460461e-05, 6.484826436504185e-05, 6.80435903087071e-05, 3.4828192077562215e-05, -2.9399605170389977e-05, -5.290065965511457e-05, -4.0960850541290157e-05, -6.237905627999574e-05, -0.00010347814039929275, -0.00010598924261524492, -7.836217037796626e-05, -7.109736321953972e-05, -6.392502051721104e-05, -5.2911836648099225e-05, -5.31765628721217e-05, -4.091634017087812e-05, -1.8154875929624324e-05, -3.7967596996894012e-06, 7.22956989121518e-06, 2.466396112283298e-05, 4.774298566150418e-05, 6.00557430259005e-05, 6.078981845430106e-05, 6.980982290750629e-05, 8.586243051368603e-05, 8.285482367783688e-05, 6.108075448750512e-05, 4.9956669522969374e-05, 3.700883075984685e-05, 2.6047945144723295e-05, 2.7735353865484032e-05, 1.729216676834705e-05, -9.691351670137674e-07, -1.2802805370225227e-05, -2.429442444605576e-05, -3.8458123163253864e-05, -5.5469820633457456e-05, -6.516780537897485e-05, -6.588979617200086e-05, -7.218931001363683e-05, -8.440955115201886e-05, -7.906263321810396e-05, -5.5369597956822584e-05, -4.178933248750531e-05, -2.6456328021008317e-05, -1.2996180174817539e-05, -1.1764404007578253e-05, 1.2443221722434303e-06, 2.227235256563346e-05, 3.582521704015639e-05, 4.7501099615639486e-05, 6.252136549842321e-05, 8.157037612963389e-05, 8.921592308233406e-05, 8.340789448070287e-05, 8.521618271584908e-05, 9.402893347993937e-05, 8.009992281754638e-05, 4.329273491998642e-05, 1.803593221075918e-05, -1.055845945194798e-05, -3.651042458916069e-05, -4.7429276458691744e-05, -7.295191266414941e-05, -0.00011372211854706441, -0.000128605015239716, -0.00011995155994102542, -0.0001265760566471207, -0.00014904061315938966, -0.00012083495610687777, -4.409666278078961e-05, 2.0096571288532155e-05, 8.674618052643814e-05, 0.00020643240924944823, 0.00037699227828424557, 0.0005417690863055701},

                .c{0.020612001581765176, 0.0126012779440961, 0.004590456380358127, 0.0031036055023299747, 0.009715490943701978, -0.0005453489279003516, 0.0022657378990149062, 0.002438675170011707, 0.0006036953447069636, 0.0004033182049359621, -0.0004225691921235917, -0.0009533051874535933, -0.0026554992288994233, 0.0005965195130788902, -0.0003077260809450354, -0.0026940171508225558, -0.0031098405176193996, 0.000986407858652286, 9.229980501365915e-05, -0.0020271287581672165, -0.0016851679225921626, 0.0014583778940434149, 0.0010364552791699887, -0.0003804974268580498, 0.0010280220033229326, -3.387697829189762e-05, 9.983808526542297e-06, 0.001096419603868246, 0.0009573520534504713, 0.000337990941096306, 0.0006566177861255516, 0.0009157739976424213, 0.0011653736609327084, -5.525065647178044e-05, 0.0001214244079205991, 0.0006915561249354632, 0.000755037128097251, -0.001026024200375945, -0.0009354973096786941, -6.644596087009068e-05, -0.0010995605090084125, 0.00011265916597211892, 3.9245973197655094e-05, -0.000979205336817434, -0.0006641498912035603, -0.0004005882542500625, -0.0006331920395529611, -0.0006407436782881597, -0.0008890840028295783, 1.711568230113064e-05, -8.20203041789678e-05, -0.0004841880254461857, -0.0006139952911283301, 0.0010944197534870023, 0.0010340603525798256, 0.00018573034016390084, 0.0011912680333579155, 1.7341846294288072e-05, 9.324395577730665e-05, 0.001074465555713898, 0.0008127973291168299, 0.0004033887407661204, 0.000644210613504543, 0.0007032659609038261, 0.001005394339770777, -0.00031969577308645737, -0.00020113489961816087, 0.0003632712543639324, 0.00042680873449644645, -0.0016754239454670101, -0.0016236479327728466, -0.0006399035347996684, -0.0019225019596491597, -0.000402880672205977, -0.0005753934565530565, -0.001711104577075034, -0.0019410760665330797, 0.0006079745056365654, 0.00016708343431042465, -0.0007603758664929082, -0.0012514369456918515, 0.003777256195340856, 0.003094331091960734, 0.002653654270657839, 0.003314060753904149, 0.0074021524940361474, 0.007868702578418896, 0.006884101625515626},

                .d{-0.24148662866825485, -0.24148662866826, -0.04482037527658053, 0.19930711508169127, -0.3092909242487461, 0.08473107212408582, 0.005212410722193497, -0.05530448358865466, -0.006038842443324277, -0.02488859206305381, -0.01599298451982801, -0.05128957206163951, 0.09798050541585525, -0.02724189364862694, -0.07188466243060906, -0.012525104599100247, 0.12337187659770713, -0.0269262040515291, -0.06382003233153588, 0.010295931584672761, 0.09463637667025404, -0.012700423303086437, -0.04264675045070536, 0.04238740326664227, -0.03195205559095794, 0.0013195685836877283, 0.032681197305167435, -0.004182698009136451, -0.01862558813739092, 0.009580372694302773, 0.007791020485276212, 0.007502537697052228, -0.036683988117706186, 0.005308833100788402, 0.017128815900313236, 0.0019068800351628968, -0.05349154342015734, 0.0027183778678641435, 0.026091738585723247, -0.03101208032457725, 0.03638213392911196, -0.002202952003289169, -0.030555896915861382, 0.009450732036133142, 0.00790467999991054, -0.0069749733239902545, -0.00022640748731631228, -0.007444248356886469, 0.027159505754432392, -0.0029706674836338215, -0.012049115715503399, -0.00388841681949428, 0.051167444462959226, -0.001807476087779578, -0.0253992347905635, 0.030101162301414935, -0.03513628537319686, 0.0022714342316803053, 0.029359313107428855, -0.007828229319904383, -0.012246292360766825, 0.0072024487726168205, 0.0017659629071611798, 0.00903344844992099, -0.03961401308652699, 0.0035439529038358737, 0.01686876288564429, 0.0018987522715331452, -0.06281565299988591, 0.0015469151290239491, 0.02938820221208379, -0.03831214281193065, 0.045387711876337784, -0.005152092174265849, -0.03391500813811877, -0.006866921601135456, 0.0761084656824308, -0.013162993420472712, -0.027687868665683034, -0.01465898766883626, 0.15010664837614204, -0.02038434465664867, -0.013153016073100699, 0.019710631652364523, 0.12201031350004568, 0.013923984117657166, -0.029384444837062436, -0.02938444483706688},
                .threshold{1.1260458985204592e-05}};
        }

        template <>
        consteval CubicSpline<double, 88> PreDefinedCubicSpline<EllipsoidType::WGS84>()
        {
            return {
                .x_knots{0.0110574388553544, 0.0221149453363708, 0.0331725869883854, 0.0442304311961701, 0.055288545103871, 0.0663469955352095, 0.0774058489140349, 0.0884651711853158, 0.0995250277366567, 0.110585483320427, 0.1216466019765889, 0.1327084469563085, 0.1437710806464378, 0.1548345644949489, 0.1658989589374081, 0.176964323324569, 0.1880307158511699, 0.1990981934860158, 0.2101668119034249, 0.2212366254161198, 0.2323076869096409, 0.2433800477783594, 0.254453757863166, 0.2655288653909081, 0.2766054169156508, 0.2876834572618312, 0.2987630294693753, 0.3098441747408488, 0.3209269323907037, 0.3320113397966886, 0.3430974323534831, 0.3541852434286178, 0.365274804320737, 0.3763661442202614, 0.3874592901725036, 0.3985542670432875, 0.4096510974871211, 0.4207498019179679, 0.4318503984826612, 0.4429529030370009, 0.4540573291245716, 0.4651636879583163, 0.4762719884048974, 0.4873822369718732, 0.498494437797717, 0.5096085926446986, 0.5207247008946482, 0.531842759547619, 0.5429627632234576, 0.5540847041662943, 0.5652085722519528, 0.5763343549982866, 0.5874620375784326, 0.5985916028369814, 0.6097230313090496, 0.6208563012422421, 0.6319913886214851, 0.6431282671967091, 0.6542669085133553, 0.665407281945674, 0.6765493547327855, 0.6876930920174599, 0.6988384568875793, 0.7099854104202359, 0.7211339117284128, 0.7322839180102007, 0.7434353846004875, 0.7545882650250656, 0.765742511057087, 0.7768980727758042, 0.7880548986275212, 0.7992129354886803, 0.8103721287310104, 0.8215324222886493, 0.8326937587271611, 0.8438560793143575, 0.8550193240928344, 0.8661834319541307, 0.8773483407144129, 0.8885139871915855, 0.8996803072837322, 0.9108472360487776, 0.922014707785273, 0.9331826561141896, 0.9443510140616218, 0.9555197141422824, 0.9666886884436836, 0.977857868710886, 0.9890271864317132},

                .y_knots{1.0650509712912246e-05, 3.5841531711573423e-06, -1.2427175305616996e-06, -4.225819552784911e-06, -5.732270279565864e-06, -6.0972640521127414e-06, -5.6216732200113195e-06, -4.570509038387998e-06, -3.172119706275853e-06, -1.618334208381202e-06, -6.52558853186648e-08, 1.3652587724196144e-06, 2.5835131564938725e-06, 3.5293407503183692e-06, 4.169137962915337e-06, 4.492583531837742e-06, 4.509059383191974e-06, 4.244125179786223e-06, 3.7358309254812436e-06, 3.0312711385513e-06, 2.183159686295548e-06, 1.2467781815633447e-06, 2.771128662614462e-07, -6.735391839922389e-07, -1.5576414385241075e-06, -2.334257888393632e-06, -2.970015168065731e-06, -3.440094975248241e-06, -3.728649714164348e-06, -3.828896057934711e-06, -3.7426897725858295e-06, -3.4800333232080038e-06, -3.058204833245807e-06, -2.5006532401897577e-06, -1.8358969167073529e-06, -1.0958390702766945e-06, -3.1481114559823737e-07, 4.7212415462956174e-07, 1.2305081950027491e-06, 1.927874911079766e-06, 2.534710278224582e-06, 3.025748947061628e-06, 3.3807551908426794e-06, 3.5852445259219315e-06, 3.6309181524485108e-06, 3.516089625654837e-06, 3.245472744412871e-06, 2.8303117629970356e-06, 2.2877648086360326e-06, 1.6403713686990486e-06, 9.151776857931494e-07, 1.429503270601682e-07, -6.430607734952184e-07, -1.408318548068617e-06, -2.1183446047468198e-06, -2.740188051299783e-06, -3.243471935364048e-06, -3.6020341115010693e-06, -3.7951908728470554e-06, -3.8085034834252005e-06, -3.63533209438811e-06, -3.2769707759131884e-06, -2.7433918954791053e-06, -2.053454204801932e-06, -1.2346430435343503e-06, -3.225892287218868e-07, 6.399663766238836e-07, 1.6044141489808365e-06, 2.517947210271647e-06, 3.3261078717437657e-06, 3.97436521722529e-06, 4.411971563741089e-06, 4.594348198699166e-06, 4.486533898494585e-06, 4.067072486611291e-06, 3.33088478064519e-06, 2.2934059804584524e-06, 9.938813622933917e-07, -5.020094857115763e-07, -2.0983267620721183e-06, -3.6671658286205333e-06, -5.045946091390089e-06, -6.037112603946536e-06, -6.406103660078384e-06, -5.8824027877203006e-06, -4.160054686300641e-06, -8.99191690185595e-07, 4.271442365683933e-06, 1.1750794813364471e-05},

                .a{1.0385491096896784e-05, 3.0858857759797835e-06, -1.1319118702579997e-06, -3.961138362313932e-06, -5.701157600056283e-06, -5.752633686756238e-06, -5.404564416266674e-06, -4.6097383219550784e-06, -3.3000773781984914e-06, -1.775945811086663e-06, -1.7853398746641018e-07, 1.3276011820568745e-06, 2.5527130447569125e-06, 3.3299645397104223e-06, 4.083731696272586e-06, 4.70170524812232e-06, 4.740278898747712e-06, 4.201200785586207e-06, 3.699978077467122e-06, 3.171260615793343e-06, 2.246082929583459e-06, 1.0220705952410354e-06, 9.85551017991422e-09, -7.889109380214931e-07, -1.5656072830705849e-06, -2.1911473040874754e-06, -2.779845351146006e-06, -3.3234966147067e-06, -3.6480557311433505e-06, -3.7570825899207916e-06, -3.7446170626032102e-06, -3.573131011298904e-06, -3.176759289050485e-06, -2.5538828439273795e-06, -1.8871806358189975e-06, -1.1743157037238814e-06, -3.1179750738785955e-07, 6.611492523647827e-07, 1.4582713237018942e-06, 2.0568940566270566e-06, 2.561058084641653e-06, 2.8863745911801705e-06, 3.1866766169533443e-06, 3.4578335575448317e-06, 3.5420992730763606e-06, 3.4601853918478003e-06, 3.2588059963884906e-06, 2.910107020875737e-06, 2.3929485684429482e-06, 1.703335621314403e-06, 9.76372882528847e-07, 2.164723815324446e-07, -6.522418321903837e-07, -1.5973185498938965e-06, -2.3443849380857614e-06, -2.867789513531776e-06, -3.2686044203348383e-06, -3.464084340520954e-06, -3.6036042207642636e-06, -3.6825416250495696e-06, -3.5461349100829622e-06, -3.213946451152028e-06, -2.7545607680100033e-06, -2.142534724206243e-06, -1.3455229670667833e-06, -3.658390582133306e-07, 5.943099254110771e-07, 1.523041882042057e-06, 2.5215266244855747e-06, 3.536527840450517e-06, 4.22389908017151e-06, 4.545709787990792e-06, 4.614101967465046e-06, 4.319922534065524e-06, 3.855054231472665e-06, 3.206731657638969e-06, 2.1694762188674147e-06, 7.637044026464786e-07, -6.148309123214423e-07, -1.9720224314975278e-06, -3.500803064099882e-06, -5.112351466035043e-06, -6.019221635824898e-06, -6.144137015395869e-06, -5.561235003443651e-06, -4.008923512264283e-06, -7.602139561712532e-07, 4.391660007884248e-06},

                .b{-0.000858565277082575, -0.0004912635898277145, -0.0003011420917409692, -0.00021605195904479097, -7.427859962686693e-05, 2.7141572729830456e-05, 4.6170591676951405e-05, 9.820578331632202e-05, 0.00013186014350472763, 0.0001430006727717991, 0.00014278763714148623, 0.00012756723268538749, 8.764151602802704e-05, 6.485999376022564e-05, 6.805572098900163e-05, 3.48365203288753e-05, -2.939939405689347e-05, -5.2903522602218666e-05, -4.0962232810866964e-05, -6.238360208393963e-05, -0.00010348872809221627, -0.00010600084795770872, -7.837090634291138e-05, -7.11061450532768e-05, -6.393432339759022e-05, -5.2920410821305605e-05, -5.3184916470327116e-05, -4.092365364570387e-05, -1.8160170325744698e-05, -3.8005656720946365e-06, 7.226981446370479e-06, 2.4663330985380143e-05, 4.774496019106542e-05, 6.005951995511647e-05, 6.079460700776967e-05, 6.981637359510717e-05, 8.587165139535286e-05, 8.286449436498776e-05, 6.108841162916266e-05, 4.996389433109326e-05, 3.701580547223446e-05, 2.605428591613419e-05, 2.7741935126450823e-05, 1.7298017421222443e-05, -9.645231428858786e-07, -1.279980598295289e-05, -2.4294155380238866e-05, -3.8460222403644886e-05, -5.547471867134775e-05, -6.517448979758046e-05, -6.589638912979545e-05, -7.219721235618009e-05, -8.441995260173058e-05, -7.9072970358719e-05, -5.5377578077620015e-05, -4.179634837086795e-05, -2.6462333739577547e-05, -1.300091621629161e-05, -1.1768755795706437e-05, 1.2413998397073598e-06, 2.2271684205736553e-05, 3.5826271006985766e-05, 4.7503798216148814e-05, 6.252613401004093e-05, 8.157771883329865e-05, 8.922486469815395e-05, 8.341729802777488e-05, 8.522680277544786e-05, 9.404183315484128e-05, 8.011198386696822e-05, 4.3300477736568576e-05, 1.8041331286339336e-05, -1.0555264245369648e-05, -3.65102478578435e-05, -4.74313712343216e-05, -7.295736510192715e-05, -0.00011373267674622465, -0.00012861791436600268, -0.00011996383758271846, -0.0001265898732970438, -0.0001490580212267921, -0.00012085035266566914, -4.4104957550094165e-05, 2.0094005540961398e-05, 8.674916966844054e-05, 0.00020644798802471492, 0.00037702714290193545, 0.0005418231908157026},

                .c{0.020614611584541306, 0.01260279487915345, 0.004590880234391836, 0.0031041217114915094, 0.009716632406368744, -0.0005453499571312654, 0.0022660544728052095, 0.002439043214283329, 0.0006038859622551679, 0.00040335367472856193, -0.0004226135377618714, -0.0009533237027258911, -0.002655737012444, 0.0005965734994184608, -0.0003077436637328783, -0.002694344608992284, -0.003110249275723202, 0.0009865378646133635, 9.230407762669151e-05, -0.002027419718780584, -0.0016854244409534925, 0.0014585423969813189, 0.0010365510634034094, -0.00038059704476864803, 0.0010280748847503575, -3.3863613432667046e-05, 9.990340704554878e-06, 0.0010965074557089372, 0.0009574473486043399, 0.00033803053557165323, 0.0006566884839539857, 0.0009158806571375401, 0.0011655028557198731, -5.5216823950241146e-05, 0.0001214818001632941, 0.000691657937973003, 0.0007551766227161324, -0.0010261232948346637, -0.0009355805297225087, -6.640215297957673e-05, -0.0010996273884617221, 0.00011266850119836257, 3.925835911950412e-05, -0.000979283925808617, -0.0006641835429969219, -0.00040070020237227983, -0.0006333261977698824, -0.0006408231358119125, -0.0008892569580168027, 1.7127607925254096e-05, -8.202403843450546e-05, -0.0004843022479978663, -0.000614106172400301, 0.001094536640149667, 0.0010341562172457089, 0.00018572166124363078, 0.0011913680830070257, 1.7356375319496966e-05, 9.326397644133795e-05, 0.0010745744011906742, 0.0008128916715813277, 0.0004034495302065518, 0.0006442978827534653, 0.0007033650235179257, 0.0010055269877593449, -0.0003196846956930212, -0.00020110480076993768, 0.00036335030854793527, 0.00042693442733537045, -0.001675625406696908, -0.0016238350867851681, -0.0006399275055536119, -0.001922676699850218, -0.0004029775025617218, -0.0005755006068154947, -0.0017112993169284027, -0.0019413404355307817, 0.000608028557437752, 0.00016708541519676944, -0.0007605159637880989, -0.0012516194348335206, 0.0037776200169647727, 0.0030946064749788503, 0.0026538946104737128, 0.003314320631302661, 0.007403024940859414, 0.007869564132590327, 0.006884969680216039},

                .d{-0.2415196928030332, -0.2415196928030282, -0.044817612274842294, 0.1993260559642778, -0.3093255071379205, 0.084740684940554, 0.005213964509903415, -0.0553098569741597, -0.006043521022794541, -0.024891009012917725, -0.0159922136538404, -0.0512962029779309, 0.09798934212752972, -0.02724406256044325, -0.07189403083217555, -0.012527559326768927, 0.12338816110600934, -0.026930003163423664, -0.0638289523118095, 0.010296973421119323, 0.09464909592488402, -0.012702497788189085, -0.04265265159193652, 0.04239201242288945, -0.03195325963191607, 0.0013193636395504472, 0.03268365884530699, -0.004182476103812763, -0.018627271936920396, 0.009581312404102605, 0.0077921052654782805, 0.007503218597823439, -0.036686871340719525, 0.005309543534787051, 0.017130158522791674, 0.0019080128349747683, -0.05349873427869039, 0.002718855831590613, 0.026095564668580203, -0.031015417556147427, 0.0363844384947218, -0.0022028614977865845, -0.03055864078371873, 0.009452084477536976, 0.007902335482762033, -0.00697564261900923, -0.00022476759885374815, -0.007447054558824283, 0.02716505960607039, -0.0029711381447607168, -0.01205243168758702, -0.0038883185685051505, 0.05117429036555047, -0.001808106451490727, -0.025402376872601447, 0.030104431380216255, -0.03513886168844849, 0.0022715996491840316, 0.029361984757845308, -0.007828666909926224, -0.01224730180774173, 0.007203244139412697, 0.0017663164077794077, 0.009034456916040046, -0.03961766627333454, 0.003544523163926689, 0.016870234051045676, 0.0019001469217759305, -0.0628254583392999, 0.001547343321480825, 0.029393091080878703, -0.038316664608296976, 0.04539006043881655, -0.0051524028269139014, -0.03391763989218388, -0.0068690039848722925, 0.07611800914866623, -0.01316455428068804, -0.027692123361935342, -0.014660260109351158, 0.15012302718782577, -0.02038699412311422, -0.013154068277220918, 0.01971122415480921, 0.12202865388774091, 0.01392366565753413, -0.029384264819788026, -0.02938426481979124},
                .threshold{1.126143610599333e-05}};
        }

        template <>
        consteval CubicSpline<double, 88> PreDefinedCubicSpline<EllipsoidType::Krasovski>()
        {
            return {
                .x_knots{0.0110576367481434, 0.0221153411134817, 0.0331731806328936, 0.0442312226827133, 0.0552895343986779, 0.0663481825961389, 0.0774072336906239, 0.088466753618838, 0.0995268077601897, 0.1105874608589297, 0.1216487769469875, 0.1327108192675927, 0.1437736501997654, 0.1548373311837604, 0.1659019226475494, 0.1769674839344239, 0.1880340732318006, 0.1991017475013129, 0.2101705624102651, 0.2212405722645322, 0.232311829942982, 0.2433843868334952, 0.2544582927706629, 0.2655335959752308, 0.2766103429953679, 0.2876885786498276, 0.2987683459730728, 0.309849686162432, 0.3209326385273535, 0.3320172404408213, 0.3431035272929967, 0.3541915324471423, 0.3652812871978921, 0.3763728207319181, 0.3874661600910515, 0.3985613301379064, 0.4096583535240571, 0.4207572506608134, 0.4318580396926387, 0.4429607364732505, 0.454065354544441, 0.4651719051176541, 0.4762803970583479, 0.4873908368731747, 0.4985032286999999, 0.5096175743007867, 0.5207338730573594, 0.5318521219700676, 0.5429723156593563, 0.5540944463702562, 0.5652185039797929, 0.5763444760073216, 0.5874723476277813, 0.5986021016878612, 0.6097337187250724, 0.6208671769897064, 0.6320024524696675, 0.6431395189181501, 0.6542783478841426, 0.6654189087457223, 0.6765611687461113, 0.6877050930324511, 0.6988506446972617, 0.7099977848225314, 0.7211464725263944, 0.7322966650123399, 0.7434483176208955, 0.7546013838837279, 0.765755815580091, 0.7769115627955588, 0.7880685739829688, 0.7992267960255018, 0.8103861743018197, 0.8215466527531816, 0.8327081739524506, 0.8438706791749064, 0.8550341084707731, 0.866198400739368, 0.877363493804776, 0.8885293244929507, 0.8996958287101448, 0.9108629415225624, 0.922030597237132, 0.933198729483293, 0.9443672712956837, 0.9555361551976286, 0.9667053132853072, 0.9778746773124932, 0.9890441787757556},

                .y_knots{1.0644995238215165e-05, 3.5819305724585056e-06, -1.2426094894904928e-06, -4.224191383532549e-06, -5.729773713438531e-06, -6.094424694653034e-06, -5.618889110733347e-06, -4.568069576035066e-06, -3.1702103200590288e-06, -1.6170790789307086e-06, -6.467307411218352e-08, 1.3651753124490989e-06, 2.5828403225767647e-06, 3.5281400211487394e-06, 4.167562030077821e-06, 4.490726966825719e-06, 4.507081693941599e-06, 4.242131026609922e-06, 3.7339468979500365e-06, 3.0295899845765345e-06, 2.1817885428286068e-06, 1.2457454583290504e-06, 2.765059250115832e-07, -6.737385862701315e-07, -1.557469666200041e-06, -2.3336888273712067e-06, -2.9691111462856073e-06, -3.43888091499384e-06, -3.727243842040174e-06, -3.8273193315004e-06, -3.7410464212342376e-06, -3.478402904031979e-06, -3.0566270383261345e-06, -2.49924194173736e-06, -1.8346833507211524e-06, -1.0949042487998478e-06, -3.142123639901734e-07, 4.724198922598016e-07, 1.2305189514837415e-06, 1.9275534562118333e-06, 2.534063167354485e-06, 3.024784131730701e-06, 3.37951529931599e-06, 3.583796390517046e-06, 3.6293551838241945e-06, 3.514492060685201e-06, 3.2438882380592723e-06, 2.8288218425580585e-06, 2.2864538368387675e-06, 1.6392009505002744e-06, 9.142763140862747e-07, 1.424113339944938e-07, -6.432654517641266e-07, -1.4081792219019108e-06, -2.1179179693104223e-06, -2.739371247944579e-06, -3.242361779432889e-06, -3.6007002284883446e-06, -3.793681179830189e-06, -3.806844686587464e-06, -3.6336978200633002e-06, -3.2753405267210364e-06, -2.741899922381521e-06, -2.0521524297365847e-06, -1.2336448113646828e-06, -3.2195632061965754e-07, 6.401787795567992e-07, 1.6042278026418694e-06, 2.5174165893676603e-06, 3.3250694349957165e-06, 3.973033439257003e-06, 4.410320645740692e-06, 4.592477556061847e-06, 4.484688474429288e-06, 4.065133273321343e-06, 3.3291592106843987e-06, 2.2921041392988395e-06, 9.928761762734682e-07, -5.023200470048381e-07, -2.098132281714085e-06, -3.666127368460656e-06, -5.04439802581462e-06, -6.034879634627972e-06, -6.4037135068706515e-06, -5.880088637885868e-06, -4.1581426457799366e-06, -8.982959679791191e-07, 4.270296071771495e-06, 1.174691009346216e-05},

                .a{1.0380062550739696e-05, 3.0838711140399993e-06, -1.1318679555783418e-06, -3.959599778017573e-06, -5.6986724733638605e-06, -5.749921811999864e-06, -5.401859773421167e-06, -4.607281958367875e-06, -3.2981247761221908e-06, -1.7746294807317034e-06, -1.779140931222185e-07, 1.3275376802954945e-06, 2.5520448651017802e-06, 3.3288448782951463e-06, 4.082176414769871e-06, 4.69978035500797e-06, 4.7382112238940504e-06, 4.199227184167486e-06, 3.698106115176342e-06, 3.1695274300002855e-06, 2.2446762083277488e-06, 1.0211464801500818e-06, 9.340339750469698e-09, -7.890888460208261e-07, -1.5654215043330573e-06, -2.1906261522318527e-06, -2.779001827167308e-06, -3.322345729263842e-06, -3.646667916579458e-06, -3.7555333485465943e-06, -3.742966685048461e-06, -3.5714567652778346e-06, -3.1751594895629627e-06, -2.5524636177538044e-06, -1.885970147254804e-06, -1.1733452372526766e-06, -3.1114982123046683e-07, 6.614058496630174e-07, 1.458180752236323e-06, 2.056505435448912e-06, 2.560376741514093e-06, 2.8854364827434035e-06, 3.185507138999692e-06, 3.456462432867355e-06, 3.5405909048493704e-06, 3.4586086649070193e-06, 3.2572181124959344e-06, 2.908576470331152e-06, 2.3915600896990377e-06, 1.7021789897997248e-06, 9.754802442221324e-07, 2.1587790398717393e-07, -6.524669118132291e-07, -1.597113972760448e-06, -2.343821404776179e-06, -2.866946966030018e-06, -3.2675085243917325e-06, -3.462797715784307e-06, -3.6021538818663282e-06, -3.6809571856147083e-06, -3.544498864459037e-06, -3.212339923362354e-06, -2.75305624083148e-06, -2.141217974465285e-06, -1.3444901583901236e-06, -3.651925164521295e-07, 5.945646968852581e-07, 1.52290230394901e-06, 2.520933894313452e-06, 3.5354459342910147e-06, 4.222448835768344e-06, 4.5440255311340925e-06, 4.61226332984882e-06, 4.318056294759884e-06, 3.8532483596004926e-06, 3.2050822831411845e-06, 2.168146207233485e-06, 7.628594163949056e-07, -6.151607202778245e-07, -1.9718001507809714e-06, -3.4999143631747482e-06, -5.110708103971104e-06, -6.017093375872552e-06, -6.141823305333443e-06, -5.558966188595708e-06, -4.007041459834224e-06, -7.594493946923388e-07, 4.390490753215906e-06},

                .b{-0.0008581506342783954, -0.0004910219794927779, -0.00030098256341557855, -0.00021593348237249727, -7.422757292002168e-05, 2.7145983927928765e-05, 4.616003245571984e-05, 9.816875831346283e-05, 0.00013180461202938994, 0.00014293687459624292, 0.00014272178495567948, 0.00012750519997331884, 8.759297754480933e-05, 6.482010224275419e-05, 6.801589658116392e-05, 3.4810770918622966e-05, -2.9398652770684585e-05, -5.289153669664835e-05, -4.095286255081956e-05, -6.236295994142508e-05, -0.00010344761311224771, -0.00010595641776801433, -7.833747658278388e-05, -7.107347962266454e-05, -6.390102462230021e-05, -5.2890251995922234e-05, -5.3154950795521484e-05, -4.089778194387125e-05, -1.8142145592498507e-05, -3.7886513395416835e-06, 7.232815886828637e-06, 2.466103420281996e-05, 4.7731945865517435e-05, 6.0040079540932334e-05, 6.0774007999887046e-05, 6.979036226950731e-05, 8.58367259646157e-05, 8.282861642470407e-05, 6.105901372384828e-05, 4.993647038772449e-05, 3.69901284076095e-05, 2.6032109283375996e-05, 2.7721563918476803e-05, 1.7282087915734037e-05, -9.735855401744116e-07, -1.2803142178230134e-05, -2.429190030136856e-05, -3.845090668121226e-05, -5.545644522982269e-05, -6.515047780179631e-05, -6.587046465385553e-05, -7.21665052576707e-05, -8.438125853323858e-05, -7.903475433494592e-05, -5.534885040186929e-05, -4.1771755444023035e-05, -2.644178494898786e-05, -1.2985358455686835e-05, -1.1754544610049767e-05, 1.2501924101662549e-06, 2.227205039703266e-05, 3.581984503886347e-05, 4.749016199328043e-05, 6.250428495240455e-05, 8.154546732515896e-05, 8.918740099678923e-05, 8.338137360524905e-05, 8.518802551220117e-05, 9.399628479537558e-05, 8.007052144325996e-05, 4.3273674346842395e-05, 1.8023541185909464e-05, -1.0563460681987206e-05, -3.650758986029726e-05, -4.7421622632407016e-05, -7.293578214185057e-05, -0.00011369338495629427, -0.00012856966154529105, -0.00011991502776900222, -0.00012653447598515313, -0.00014898825789422327, -0.00012078911839391017, -4.4075511746317875e-05, 2.0099630309185588e-05, 8.673295671439977e-05, 0.00020638183033482222, 0.00037688272656199827, 0.0005416103285029913},

                .c{0.0206043623220822, 0.012596801559313163, 0.004589142923204217, 0.0031020089696815697, 0.009712416332500726, -0.000545513195892652, 0.002264833268233494, 0.002437787297154952, 0.0006034142454458516, 0.00040306000769939235, -0.0004225052200819997, -0.0009530621969777535, -0.002654714390517371, 0.0005963691313763176, -0.00030753837347001923, -0.0026932245161565087, -0.003108872404936261, 0.0009862147124634429, 9.237177073568345e-05, -0.0020264348540086213, -0.0016844943253197474, 0.0014579157057132794, 0.0010361402617057867, -0.00038026684443235475, 0.001027790434826277, -3.388012547611825e-05, 9.989840429794946e-06, 0.001096119045517058, 0.0009570916516069658, 0.00033781224886755433, 0.0006563409219217848, 0.0009154673586213782, 0.0011649133333986677, -5.5226053667988716e-05, 0.00012138543410291594, 0.0006912523381479137, 0.0007547537786937013, -0.0010257815666664088, -0.0009353045001387188, -6.64830435458613e-05, -0.001099369027828174, 0.0001127423472940585, 3.9344420569707174e-05, -0.0009789540288960479, -0.000663867223306328, -0.00040048303742502075, -0.0006330226621537601, -0.0006404698177330619, -0.0008887785949983303, 1.7180083530262952e-05, -8.190348548765415e-05, -0.00048398330518888236, -0.0006136887108244751, 0.001094068076750397, 0.0010337363432092893, 0.00018574951959531656, 0.0011909537799883224, 1.7302142300293983e-05, 9.319545573221148e-05, 0.0010741368879261157, 0.0008125412174252685, 0.0004031700790376534, 0.0006439128564139116, 0.0007029907251682535, 0.0010049396500055553, -0.00031957626446196786, -0.00020106651337042602, 0.0003630535279166262, 0.00042661102182877715, -0.0016749149752212568, -0.0016231768235877887, -0.0006397404283439449, -0.0019219615912536227, -0.0004026815045935866, -0.0005751451354547799, -0.0017105567747325676, -0.0019404362789462392, 0.0006079490750019656, 0.0001672019896230999, -0.0007600327785729408, -0.0012507829138168162, 0.0037759780984625907, 0.003093288702761412, 0.0026529847690237684, 0.0033131769309117875, 0.007399520476533487, 0.00786581061545512, 0.006882352443788807},

                .d{-0.24138707571979412, -0.2413870757197982, -0.04482812740334718, 0.1992590892295636, -0.30919781348888986, 0.08470728154749889, 0.005212825090783841, -0.055285234239215705, -0.006038047240003759, -0.024878450906720556, -0.01598731233404325, -0.051272355270021226, 0.09795062862582497, -0.027231236020011772, -0.07186519450866864, -0.01251960224933631, 0.12333476807258664, -0.026917754944263617, -0.06380020290971321, 0.010295142570070125, 0.09460055348569008, -0.01269577468572257, -0.04262959607745273, 0.042372767525183916, -0.03194463430871344, 0.001319822117379551, 0.032671415386206555, -0.004181418733096374, -0.01862281290670393, 0.009577257540524119, 0.007789992672177861, 0.007497790539820087, -0.03666879136005199, 0.005306832687415003, 0.017120569930833197, 0.0019074616779678887, -0.05347484299328862, 0.002716835901433079, 0.026084397144245954, -0.03100469785515035, 0.03637827265786787, -0.0022024569766448334, -0.030550799261395072, 0.00945151474438064, 0.007899226079571211, -0.006972933162405534, -0.0002232712374574485, -0.007443179024973408, 0.027151832146716806, -0.00296904758125229, -0.012046282898739736, -0.0038853014023251084, 0.05114688603648023, -0.0018066178327737874, -0.025388542159975748, 0.03009068679087939, -0.03512749199911405, 0.0022711338167780573, 0.029350450256559555, -0.007825930900066188, -0.012244972473159534, 0.007199965948039705, 0.0017666076407771517, 0.009027936227647679, -0.03959620476319246, 0.0035423673737417114, 0.016859938722770116, 0.001899319649871367, -0.06279352267072363, 0.0015457590079277783, 0.029378527376349967, -0.038300256853041545, 0.04537679076756296, -0.005150541393721159, -0.033905520211049825, -0.006864064739759555, 0.07608738325840225, -0.01315848370144523, -0.027680722079430654, -0.014649470884786162, 0.1500465726673688, -0.020376983112356202, -0.013141676215644656, 0.01970391996191737, 0.12195618892323079, 0.013916003792503866, -0.029349870749806165, -0.029349870749802855},
                .threshold{1.1257736487532196e-05}};
        }

        constexpr CubicSpline<double, 88>
            Spline_CGCS2000 = PreDefinedCubicSpline<EllipsoidType::CGCS2000>(),
            Spline_IE1975 = PreDefinedCubicSpline<EllipsoidType::IE1975>(),
            Spline_WGS84 = PreDefinedCubicSpline<EllipsoidType::WGS84>(),
            Spline_Krasovski = PreDefinedCubicSpline<EllipsoidType::Krasovski>();

        template <EllipsoidType __ellipsoid_type>
        constexpr double SplineFit(double len)
        {
            AGTB_TEMPLATE_NOT_SPECIFIED();
            return 0.0;
        }

        template <>
        constexpr double SplineFit<EllipsoidType::CGCS2000>(double len)
        {
            return Spline_CGCS2000(len / 1e7);
        }

        template <>
        constexpr double SplineFit<EllipsoidType::IE1975>(double len)
        {
            return Spline_IE1975(len / 1e7);
        }

        template <>
        constexpr double SplineFit<EllipsoidType::WGS84>(double len)
        {
            return Spline_WGS84(len / 1e7);
        }

        template <>
        constexpr double SplineFit<EllipsoidType::Krasovski>(double len)
        {
            return Spline_Krasovski(len / 1e7);
        }
    }

    template <EllipsoidType __ellipsoid_type>
    double MeridianArcBottom(double len)
    {
        using namespace MeridianArcBottomImpl;
        using Utils::Angles::Sec2Rad;

        return (SinFit<SinCoeff<__ellipsoid_type>>(len) +
                DoubleGaussianFit<DoubleGaussianCoeff<__ellipsoid_type>>(len) +
                SplineFit<__ellipsoid_type>(len)) *
               Sec2Rad;
    }
}

AGTB_GEODESY_END

#endif